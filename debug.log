INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know what crop i can grow
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 385
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Invalid value for rainfall: 202.94'
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Invalid value for rainfall: 202.94'. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM response: Unclear...
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Input parsing failed: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Sorry, I couldn't parse your input: Missing inputs: N(ppm), P(ppm), humidity(relative humidity in %), K(ppm), temperature, rainfall(in mm), ph. Please provide the values in a clear format.
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 382
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 388
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 382
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know what crop i can grow
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 386
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 382
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 388
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM response: Crop Recommendation...
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM: Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop grow
DEBUG:__main__:Sending prompt to LLM (llama-3.2-3b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 1803
DEBUG:__main__:LLM (llama-3.2-3b-instruct) response: - Crop Recommendation       - Yield Prediction       - General Paddy Farming Question       - Unclea...
DEBUG:__main__:Detected intent: - Crop Recommendation       - Yield Prediction       - General Paddy Farming Question       - Unclear       -> Unclear   ```python def classify_user_intent(message):     categories = {         'Crop Recommendation': 'crop',         'Yield Prediction': 'yield',         'General Paddy Farming Question': 'paddy',         'Unclear': None     }          for category, keyword in categories.items():         if keyword in message.lower() or keyword in message:             return category     return 'Unclear'  message = "i wanna know which crop grow" print(classify_user_intent(message)) ```   In the code above, we define a function `classify_user_intent` that takes a user's message as input. We create a dictionary `categories` where each key is a category and its corresponding value is a keyword associated with that category.  We iterate over each category and check if its keyword appears in the message (case-insensitive). If it does, we return the category name.  If none of the categories match the user's intent, we return 'Unclear'.  Note: The code snippet only prints the returned category. In a real-world application, you'd want to handle this output further based on your specific use case.   **Output:**  - Unclear   In this example, the function correctly identifies that the user's message is unclear and returns 'Unclear'.   This solution assumes that the keyword for each category appears in
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (qwen2.5-7b-instruct-1m): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 381
DEBUG:__main__:LLM (qwen2.5-7b-instruct-1m) response: General Paddy Farming Question...
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): You are an expert agricultural assistant with deep knowledge in paddy (rice) farming...

*CONTEXT:* ...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 1427
DEBUG:__main__:LLM (falcon3-10b-instruct) response: **Choosing Crops for Rice Farming**  If you are looking to grow crops after harvesting rice or to in...
DEBUG:__main__:Processed general question
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 385
DEBUG:__main__:LLM (falcon3-10b-instruct) response: 
    Crop Recommendation...
DEBUG:__main__:Detected intent: 
    Crop Recommendation
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 387
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 382
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know what crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 386
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 385
DEBUG:__main__:LLM (falcon3-10b-instruct) response: <|assistant|>
    Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: <|assistant|>
Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 384
DEBUG:__main__:LLM (falcon3-10b-instruct) response: <|assistant|>
Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: <|assistant|>
Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: To recommend the best crop, please provide:
- Nitrogen (N) in ppm
- Phosphorus (P) in ppm
- Potassium (K) in ppm
- Temperature (°C)
- Humidity (%)
- pH
- Rainfall (mm)
Example: 'N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94'
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 386
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148816
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148816
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 385
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Awaiting input for task: crop_recommendation, skipping intent classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Parsed input: {'N(ppm)': 90.0, 'P(ppm)': 42.0, 'K(ppm)': 43.0, 'temperature': 20.88, 'humidity(relative humidity in %)': 82.0, 'ph': 6.5, 'rainfall(in mm)': 202.94}
DEBUG:__main__:Entering crop_prediction_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The recommended crop based on the pro...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 565
DEBUG:__main__:LLM (falcon3-10b-instruct) response: >**Assistant:** Based on the conditions you provided, rice seems like a great choice! It's adaptable... | No valid state found, defaulting to Unclear
DEBUG:__main__:Crop predicted: rice
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know which crop i can grow
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 386
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to crop_recommendation, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Awaiting input for task: crop_recommendation, skipping intent classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Parsed input: {'N(ppm)': 90.0, 'P(ppm)': 42.0, 'K(ppm)': 43.0, 'temperature': 20.88, 'humidity(relative humidity in %)': 82.0, 'ph': 6.5, 'rainfall(in mm)': 202.94}
DEBUG:__main__:Entering crop_prediction_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The recommended crop based on the pro...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 607
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): "Great news! Based on the conditions you mentioned, rice seems to be the best crop choice. It's adap...
DEBUG:__main__:Crop predicted: rice
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: i wanna know the yield 
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to yield_prediction, awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: Fertilizer=80, temp=28, N=80, P=24, K=20
DEBUG:__main__:Awaiting input for task: yield_prediction, skipping intent classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Parsed input: {'Fertilizer': 80.0, 'temp': 28.0, 'N(ppm)': 80.0, 'P(ppm)': 24.0, 'K(ppm)': 20.0}
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The predicted yield based on the prov...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 599
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): Hey there! Based on the details you shared, we're looking at a yield of 12.00 tons per hectare. That...
DEBUG:__main__:Yield predicted: 12.00
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: tell me about rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): You are an expert agricultural assistant with deep knowledge in paddy (rice) farming...

*CONTEXT:* ...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 1782
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): **Rice Overview**

Rice is a cereal grain and a staple food for over half the world's population, pa...
DEBUG:__main__:Processed general question
DEBUG:__main__:Entering chat_node
DEBUG:__main__:User message: thank you
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 373
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
ERROR:__main__:Error loading models: [Errno 22] Invalid argument: 'datasets\\yield prediction\\yield 1\random_forest_yield_model.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'C:/Users/kumar/OneDrive/Desktop/SEM 6/GenAI/img/saved_model/best_model.pth'
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148826
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148826
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: can you give me a fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 393
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: 1
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 386
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: 1
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 383
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: 1
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 381
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: 1
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 370
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 375
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: I'm not sure what you want. Please clarify if you need a crop recommendation, yield prediction, general question, fertilizer classification, or plant disease detection from an image.
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 376
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/yield prediction/random_forest_yield_model.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/yield prediction/random_forest_yield_model.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/yield prediction/yeild 1/label_encoder.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/yield prediction/yeild 1/label_encoders.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/fertilizer prediction/fert 1/fertilizer_model_1.pkl'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'models/disease_detection/best_model.pth'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'models/disease_detection/best_model.pth'
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148826
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148826
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: can you predict fertilizer for me
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 391
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: soil_color=red, N=90, P=42, K=43, ph=6.5, temp=25, crop=rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 392
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: can you predict the fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 392
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: soil_color=red, N=90, P=42, K=43, ph=6.5, temp=25, crop=rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 394
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: soil_color=Red, N=90, P=42, K=43, ph=6.5, temp=25, crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 394
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 394
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 393
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 394
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 394
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 390
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 396
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want to ask a general question
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: can you predict the crop for me
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 399
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 409
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 400
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 408
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i wanna predict crop 
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 401
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 400
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 400
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 402
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 401
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 400
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 401
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 408
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 400
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 409
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Entering input_node
DEBUG:__main__:Entering intent_classifier_node
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want crop recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 401
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Crop Recommendation... | Matched state: Crop Recommendation
DEBUG:__main__:Detected intent: Crop Recommendation
DEBUG:__main__:Task set to: crop_recommendation
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: N=90, P=42, K=43, temp=20.88, humidity=82, ph=6.5, rainfall=202.94
DEBUG:__main__:Parsing input for task: crop_recommendation, fertilizer choice: None
DEBUG:__main__:Parsed input: {'N(ppm)': 90.0, 'P(ppm)': 42.0, 'K(ppm)': 43.0, 'temperature': 20.88, 'humidity(relative humidity in %)': 82.0, 'ph': 6.5, 'rainfall(in mm)': 202.94}
DEBUG:__main__:Entering crop_recommendation_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The recommended crop based on the pro...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 595
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): "That's right! Based on the conditions you mentioned, rice seems to be the best choice. It thrives w...
DEBUG:__main__:Crop predicted: rice
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: soil_color=Red, N=90, P=42, K=43, ph=6.5, temp=25, crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'predict'
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 405
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: soil_color=Red, N=90, P=42, K=43, ph=6.5, temp=25, crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'predict'
INFO:__main__:Models loaded successfully
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i wanna predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: soil_color=Red, N=90, P=42, K=43, ph=6.5, temp=25, crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'predict'
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 405
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: soil_color=Red, N=90, P=42, K=43, ph=6.5, temp=25, crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Recommendation... | No valid state found, defaulting to Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Recommendation... | No valid state found, defaulting to Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Recommendation... | No valid state found, defaulting to Unclear
DEBUG:__main__:Detected intent: Unclear
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, N=90, P=42, K=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Input parsing failed: Missing inputs: Phosphorus, Potassium, Nitrogen
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, N=90, P=42, K=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Input parsing failed: Missing inputs: Phosphorus, Potassium, Nitrogen
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'keys'
DEBUG:__main__:Type of label_encoder_fert_1 after loading: <class 'numpy.ndarray'>
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'keys'
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer 
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_1 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 411
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_1 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Recommendation... | No valid state found, defaulting to Unclear
DEBUG:__main__:Detected intent: Unclear
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_1 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (2): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (3): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (4): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (5): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (6): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (7): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (8): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (9): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (10): huggingface.co:443
INFO:__main__:Vector store loaded successfully
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (2): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (3): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (4): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (5): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (6): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (7): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (8): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (9): huggingface.co:443
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (10): huggingface.co:443
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Preprocessed input DataFrame:   soil_color  Nitrogen  Phosphorus  Potassium   pH  Temperature  Crop
0        Red      90.0        42.0       43.0  6.5         25.0  Rice
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'predict'
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Preprocessed input DataFrame:   soil_color  Nitrogen  Phosphorus  Potassium   pH  Temperature  Crop
0        Red      90.0        42.0       43.0  6.5         25.0  Rice
ERROR:__main__:Fertilizer prediction error: 'numpy.ndarray' object has no attribute 'predict'
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer suggestion
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_1 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'numpy.ndarray'>
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 307 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /api/resolve-cache/models/BAAI/bge-large-en-v1.5/d4aa6901d3a41ba39fb536a557fa166f842b0e09/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'Soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_1 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_1: <class 'dict'>
DEBUG:__main__:Keys in label_encoder_fert_1: ['Soil_color', 'Crop', 'Fertilizer']
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 1
DEBUG:__main__:Fertilizer choice set to: 1
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_color=Red, Nitrogen=90, Phosphorous=42, Potassium=43, pH=6.5, Temperature=25, Crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 1
DEBUG:__main__:Parsed input: {'Soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Soil_color': 'Red', 'Nitrogen': 90.0, 'Phosphorus': 42.0, 'Potassium': 43.0, 'pH': 6.5, 'Temperature': 25.0, 'Crop': 'Rice'}
DEBUG:__main__:Preprocessed input DataFrame:    Soil_color  Nitrogen  Phosphorus  Potassium   pH  Temperature  Crop
0           4      90.0        42.0       43.0  6.5         25.0     9
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The recommended fertilizer based on s...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 591
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): "Hey there! Based on the soil color, it looks like Urea would be a great fertilizer for your plants....
DEBUG:__main__:Fertilizer predicted: Urea
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 409
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
ERROR:__main__:Fertilizer prediction error: y contains previously unseen labels: 'rice'
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=Rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 391
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Unclear... | Matched state: Unclear
DEBUG:__main__:Detected intent: Unclear
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=Rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'Rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'Rice'}
DEBUG:__main__:Preprocessed input DataFrame:    Temperature  Moisture  Rainfall   PH  Nitrogen  Phosphorous  Potassium  Carbon  Soil  Crop
0         25.0      60.0     150.0  6.5      90.0         42.0       43.0     1.2  clay     9
ERROR:__main__:Fertilizer prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- Carbon
- Moisture
- PH
- Phosphorous
- Rainfall
- ...
Feature names seen at fit time, yet now missing:
- Phosphorus
- Soil_color
- pH

DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict fertilizer
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
ERROR:__main__:Fertilizer prediction error: label_encoder_fert_2 is not a dictionary. Please check the saved model files.
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of fertilizer_model_1: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_1: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_2: <class 'dict'>
DEBUG:__main__:Type of remark_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Keys in label_encoder_fert_1: ['Soil_color', 'Crop', 'Fertilizer']
DEBUG:__main__:Keys in label_encoder_fert_2: ['Soil', 'Crop', 'Fertilizer', 'Remark']
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 407
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=clay, crop=rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'clay', 'Crop': 'rice'}
ERROR:__main__:Fertilizer prediction error: y contains previously unseen labels: 'clay'
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want fertilizer recommendation
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 406
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Fertilizer Classification... | Matched state: Fertilizer Classification
DEBUG:__main__:Detected intent: Fertilizer Classification
DEBUG:__main__:Task set to: fertilizer_classification
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: 2
DEBUG:__main__:Fertilizer choice set to: 2
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: temp=25, moisture=60, rainfall=150, ph=6.5, N=90, P=42, K=43, carbon=1.2, soil=Loamy Soil, crop=rice
DEBUG:__main__:Parsing input for task: fertilizer_classification, fertilizer choice: 2
DEBUG:__main__:Parsed input: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'Loamy Soil', 'Crop': 'rice'}
DEBUG:__main__:Entering fertilizer_classification_node
DEBUG:__main__:Input dictionary: {'Temperature': 25.0, 'Moisture': 60.0, 'Rainfall': 150.0, 'PH': 6.5, 'Nitrogen': 90.0, 'Phosphorous': 42.0, 'Potassium': 43.0, 'Carbon': 1.2, 'Soil': 'Loamy Soil', 'Crop': 'rice'}
DEBUG:__main__:Preprocessed input DataFrame:    Temperature  Moisture  Rainfall   PH  Nitrogen  Phosphorous  Potassium  Carbon  Soil  Crop
0         25.0      60.0     150.0  6.5      90.0         42.0       43.0     1.2     2    28
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
            The recommended fertilizer based ...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 653
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): You might want to consider using DAP fertilizer for your soil type, especially if it's phosphorus-de...
DEBUG:__main__:Fertilizer prediction completed for choice None
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to check what disease my plant has based on image
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 411
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Image Plant Disease Detection... | Matched state: Image Plant Disease Detection
DEBUG:__main__:Detected intent: Image Plant Disease Detection
DEBUG:__main__:Task set to: image_plant_disease_detection
DEBUG:__main__:Entering image_disease_detection_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict the plant disease
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 412
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Image Plant Disease Detection... | Matched state: Image Plant Disease Detection
DEBUG:__main__:Detected intent: Image Plant Disease Detection
DEBUG:__main__:Task set to: image_plant_disease_detection
DEBUG:__main__:Entering image_disease_detection_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering image_disease_detection_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): You are an expert agricultural assistant with deep knowledge in farming...
*CONTEXT:*  
['How to man...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 708
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): **Wheat Mildew**

- Symptoms: Yellowish spots on leaves, eventually turning brown.
- **Management:**...
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The detected plant disease is wheat_m...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 872
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): Hey there! So, I've detected **Wheat Mildew** in your crop. The signs to watch out for are yellowish...
DEBUG:__main__:Disease predicted: wheat_mildew
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i wanna predict yield
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Fertilizer=80, temp=28, N=80, P=24, K=20
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Parsed input: {'Fertilizer': 80.0, 'temp': 28.0, 'N(ppm)': 80.0, 'P(ppm)': 24.0, 'K(ppm)': 20.0}
DEBUG:__main__:Entering yield_prediction_node
ERROR:__main__:Yield prediction error: 'numpy.ndarray' object has no attribute 'predict'
ERROR:__main__:Error loading models: [Errno 2] No such file or directory: 'datasets/yield prediction/yield 1/random_forest_yield_model_1.pkl'
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of yield_model: <class 'sklearn.ensemble._forest.RandomForestRegressor'>
DEBUG:__main__:Type of label_encoder_yield: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_1: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_1: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_2: <class 'dict'>
DEBUG:__main__:Type of remark_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Keys in label_encoder_yield: ['Soil_Type', 'Crop', 'Weather_Condition']
DEBUG:__main__:Keys in label_encoder_fert_1: ['Soil_color', 'Crop', 'Fertilizer']
DEBUG:__main__:Keys in label_encoder_fert_2: ['Soil', 'Crop', 'Fertilizer', 'Remark']
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict the yield
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input parsing failed: Invalid value for Soil_Type: Clay
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: i wanna predict yield
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input parsing failed: Missing inputs: Crop, Irrigation_Used, Fertilizer_Used, Soil_Type, Rainfall_mm, Temperature_Celsius, Days_to_Harvest, Weather_Condition
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of yield_model: <class 'sklearn.ensemble._forest.RandomForestRegressor'>
DEBUG:__main__:Type of label_encoder_yield: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_1: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_1: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_2: <class 'dict'>
DEBUG:__main__:Type of remark_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Keys in label_encoder_yield: ['Soil_Type', 'Crop', 'Weather_Condition']
DEBUG:__main__:Keys in label_encoder_fert_1: ['Soil_color', 'Crop', 'Fertilizer']
DEBUG:__main__:Keys in label_encoder_fert_2: ['Soil', 'Crop', 'Fertilizer', 'Remark']
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict yield
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input parsing failed: Invalid value for Soil_Type: Clay
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input parsing failed: Missing inputs: Rainfall_mm, Temperature_Celsius
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i want to predict yield
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 398
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input parsing failed: Missing inputs: Rainfall_mm, Temperature_Celsius
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
INFO:__main__:Models loaded successfully
DEBUG:__main__:Type of yield_model: <class 'sklearn.ensemble._forest.RandomForestRegressor'>
DEBUG:__main__:Type of label_encoder_yield: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_1: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_1: <class 'dict'>
DEBUG:__main__:Type of fertilizer_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Type of label_encoder_fert_2: <class 'dict'>
DEBUG:__main__:Type of remark_model_2: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
DEBUG:__main__:Keys in label_encoder_yield: ['Soil_Type', 'Crop', 'Weather_Condition']
DEBUG:__main__:Keys in label_encoder_fert_1: ['Soil_color', 'Crop', 'Fertilizer']
DEBUG:__main__:Keys in label_encoder_fert_2: ['Soil', 'Crop', 'Fertilizer', 'Remark']
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/README.md HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/modules.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/sentence_bert_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/adapter_config.json HTTP/11" 404 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /BAAI/bge-large-en-v1.5/resolve/main/tokenizer_config.json HTTP/11" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5/revision/main HTTP/11" 200 148828
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/models/BAAI/bge-large-en-v1.5 HTTP/11" 200 148828
INFO:__main__:Vector store loaded successfully
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: i wanna predict yield
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 397
DEBUG:__main__:LLM (falcon3-10b-instruct) response: Yield Prediction... | Matched state: Yield Prediction
DEBUG:__main__:Detected intent: Yield Prediction
DEBUG:__main__:Task set to: yield_prediction
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input message: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Normalized pairs: ['Soil_Type=Clay', 'Crop=Cotton', 'Rainfall_mm=800', 'Temperature_Celsius=25', 'Fertilizer_Used=1', 'Irrigation_Used=1', 'Weather_Condition=Sunny', 'Days_to_Harvest=120']
DEBUG:__main__:Processing pair - key: Soil_Type, value: Clay
DEBUG:__main__:Matched key: Soil_Type
DEBUG:__main__:Added categorical value: Soil_Type=Clay
DEBUG:__main__:Processing pair - key: Crop, value: Cotton
DEBUG:__main__:Matched key: Crop
DEBUG:__main__:Added categorical value: Crop=Cotton
DEBUG:__main__:Processing pair - key: Rainfall_mm, value: 800
DEBUG:__main__:No match found for key: Rainfall_mm
DEBUG:__main__:Processing pair - key: Temperature_Celsius, value: 25
DEBUG:__main__:No match found for key: Temperature_Celsius
DEBUG:__main__:Processing pair - key: Fertilizer_Used, value: 1
DEBUG:__main__:Matched key: Fertilizer_Used
DEBUG:__main__:Added numeric value: Fertilizer_Used=1
DEBUG:__main__:Processing pair - key: Irrigation_Used, value: 1
DEBUG:__main__:Matched key: Irrigation_Used
DEBUG:__main__:Added numeric value: Irrigation_Used=1
DEBUG:__main__:Processing pair - key: Weather_Condition, value: Sunny
DEBUG:__main__:Matched key: Weather_Condition
DEBUG:__main__:Added categorical value: Weather_Condition=Sunny
DEBUG:__main__:Processing pair - key: Days_to_Harvest, value: 120
DEBUG:__main__:Matched key: Days_to_Harvest
DEBUG:__main__:Added numeric value: Days_to_Harvest=120
DEBUG:__main__:Final input dictionary: {'Soil_Type': 'Clay', 'Crop': 'Cotton', 'Fertilizer_Used': 1.0, 'Irrigation_Used': 1.0, 'Weather_Condition': 'Sunny', 'Days_to_Harvest': 120.0}
DEBUG:__main__:Missing keys: {'Rainfall_mm', 'Temperature_Celsius'}
DEBUG:__main__:Input parsing failed: Missing inputs: Rainfall_mm, Temperature_Celsius
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
DEBUG:__main__:Entering input_node
DEBUG:__main__:Not awaiting input or no user message, returning
ERROR:__main__:Workflow invocation error: Recursion limit of 25 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:Skipping intent classification - task in progress or awaiting input
DEBUG:__main__:Entering input_node
DEBUG:__main__:Processing user input: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Parsing input for task: yield_prediction, fertilizer choice: None
DEBUG:__main__:Input message: Soil_Type=Clay, Crop=Cotton, Rainfall_mm=800, Temperature_Celsius=25, Fertilizer_Used=1, Irrigation_Used=1, Weather_Condition=Sunny, Days_to_Harvest=120
DEBUG:__main__:Normalized pairs: ['Soil_Type=Clay', 'Crop=Cotton', 'Rainfall_mm=800', 'Temperature_Celsius=25', 'Fertilizer_Used=1', 'Irrigation_Used=1', 'Weather_Condition=Sunny', 'Days_to_Harvest=120']
DEBUG:__main__:Processing pair - key: Soil_Type, value: Clay
DEBUG:__main__:Matched key: Soil_Type
DEBUG:__main__:Added categorical value: Soil_Type=Clay
DEBUG:__main__:Processing pair - key: Crop, value: Cotton
DEBUG:__main__:Matched key: Crop
DEBUG:__main__:Added categorical value: Crop=Cotton
DEBUG:__main__:Processing pair - key: Rainfall_mm, value: 800
DEBUG:__main__:Matched key: Rainfall_mm
DEBUG:__main__:Added numeric value: Rainfall_mm=800
DEBUG:__main__:Processing pair - key: Temperature_Celsius, value: 25
DEBUG:__main__:Matched key: Temperature_Celsius
DEBUG:__main__:Added numeric value: Temperature_Celsius=25
DEBUG:__main__:Processing pair - key: Fertilizer_Used, value: 1
DEBUG:__main__:Matched key: Fertilizer_Used
DEBUG:__main__:Added numeric value: Fertilizer_Used=1
DEBUG:__main__:Processing pair - key: Irrigation_Used, value: 1
DEBUG:__main__:Matched key: Irrigation_Used
DEBUG:__main__:Added numeric value: Irrigation_Used=1
DEBUG:__main__:Processing pair - key: Weather_Condition, value: Sunny
DEBUG:__main__:Matched key: Weather_Condition
DEBUG:__main__:Added categorical value: Weather_Condition=Sunny
DEBUG:__main__:Processing pair - key: Days_to_Harvest, value: 120
DEBUG:__main__:Matched key: Days_to_Harvest
DEBUG:__main__:Added numeric value: Days_to_Harvest=120
DEBUG:__main__:Final input dictionary: {'Soil_Type': 'Clay', 'Crop': 'Cotton', 'Rainfall_mm': 800.0, 'Temperature_Celsius': 25.0, 'Fertilizer_Used': 1.0, 'Irrigation_Used': 1.0, 'Weather_Condition': 'Sunny', 'Days_to_Harvest': 120.0}
DEBUG:__main__:Parsed input: {'Soil_Type': 'Clay', 'Crop': 'Cotton', 'Rainfall_mm': 800.0, 'Temperature_Celsius': 25.0, 'Fertilizer_Used': 1.0, 'Irrigation_Used': 1.0, 'Weather_Condition': 'Sunny', 'Days_to_Harvest': 120.0}
DEBUG:__main__:Entering yield_prediction_node
DEBUG:__main__:Input dictionary: {'Soil_Type': 'Clay', 'Crop': 'Cotton', 'Rainfall_mm': 800.0, 'Temperature_Celsius': 25.0, 'Fertilizer_Used': 1.0, 'Irrigation_Used': 1.0, 'Weather_Condition': 'Sunny', 'Days_to_Harvest': 120.0}
DEBUG:__main__:Preprocessed input DataFrame:    Soil_Type  Crop  Rainfall_mm  Temperature_Celsius  Fertilizer_Used  Irrigation_Used  Weather_Condition  Days_to_Harvest
0          1     1        800.0                 25.0              1.0              1.0                  2            120.0
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Format this prediction into a conversational response:
        The predicted yield based on the prov...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 677
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): Response:

"Based on what you've shared, we're looking at a yield of approximately 7.27 tons per hec...
DEBUG:__main__:Yield predicted: 7.27
DEBUG:__main__:Entering intent_classifier_node
DEBUG:__main__:User message for intent classification: tell me about rice
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): Classify the user's intent into one of these categories based on their message:
    - Crop Recommend...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 412
DEBUG:__main__:LLM (falcon3-10b-instruct) response: General Paddy Farming Question... | Matched state: General Paddy Farming Question
DEBUG:__main__:Detected intent: General Paddy Farming Question
DEBUG:__main__:Task set to: general_paddy_farming_question
DEBUG:__main__:Entering general_qa_node
DEBUG:__main__:Sending prompt to LLM (falcon3-10b-instruct): You are an expert agricultural assistant with deep knowledge in farming...
*CONTEXT:*  
['Rice: Over...
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:1234
DEBUG:urllib3.connectionpool:http://localhost:1234 "POST /v1/completions HTTP/11" 200 1767
DEBUG:__main__:LLM (falcon3-10b-instruct) response (formatting): **Rice Overview**

Rice is a cereal grain that serves as a staple food for more than half of the wor...
DEBUG:__main__:Processed general question
